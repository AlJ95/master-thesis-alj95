<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 13: 11.5. Combining Multiple Indexes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/13/indexes-bitmap-scans.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-02-20T14:13:26" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="11.5. Combining Multiple Indexes" />
  <meta property="og:description" content="11.5.&amp;nbsp;Combining Multiple Indexes A single index scan can only use query clauses that use the index&#x27;s columns with operators of …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />


  

  
  
  
  
  

  

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          
          
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 20, 2025: <a href="/about/news/postgresql-174-168-1512-1417-and-1320-released-3018/">
  PostgreSQL 17.4, 16.8, 15.12, 14.17, and 13.20 Released!
</a>

</div>
      </div>
    </div>
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/13/index.html">PostgreSQL 13</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/indexes-bitmap-scans.html" title="PostgreSQL 17 - 11.5. Combining Multiple Indexes" >Current</a>
                          (<a href="/docs/17/indexes-bitmap-scans.html" title="PostgreSQL 17 - 11.5. Combining Multiple Indexes" >17</a>)
                        
                      
                         / 
                        
                          <a href="/docs/16/indexes-bitmap-scans.html" title="PostgreSQL 16 - 11.5. Combining Multiple Indexes" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/indexes-bitmap-scans.html" title="PostgreSQL 15 - 11.5. Combining Multiple Indexes" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/indexes-bitmap-scans.html" title="PostgreSQL 14 - 11.5. Combining Multiple Indexes" >14</a>
                        
                      
                         / 
                        
                          <a href="/docs/13/indexes-bitmap-scans.html" title="PostgreSQL 13 - 11.5. Combining Multiple Indexes" class="docs-version-selected">13</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/indexes-bitmap-scans.html" title="PostgreSQL devel - 11.5. Combining Multiple Indexes"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/12/indexes-bitmap-scans.html" title="PostgreSQL 12 - 11.5. Combining Multiple Indexes"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/indexes-bitmap-scans.html" title="PostgreSQL 11 - 11.5. Combining Multiple Indexes"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/indexes-bitmap-scans.html" title="PostgreSQL 10 - 11.5. Combining Multiple Indexes"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/indexes-bitmap-scans.html" title="PostgreSQL 9.6 - 11.5. Combining Multiple Indexes"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/indexes-bitmap-scans.html" title="PostgreSQL 9.5 - 11.5. Combining Multiple Indexes"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/indexes-bitmap-scans.html" title="PostgreSQL 9.4 - 11.5. Combining Multiple Indexes"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/indexes-bitmap-scans.html" title="PostgreSQL 9.3 - 11.5. Combining Multiple Indexes"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/indexes-bitmap-scans.html" title="PostgreSQL 9.2 - 11.5. Combining Multiple Indexes"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/indexes-bitmap-scans.html" title="PostgreSQL 9.1 - 11.5. Combining Multiple Indexes"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/indexes-bitmap-scans.html" title="PostgreSQL 9.0 - 11.5. Combining Multiple Indexes"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/indexes-bitmap-scans.html" title="PostgreSQL 8.4 - 11.5. Combining Multiple Indexes"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/indexes-bitmap-scans.html" title="PostgreSQL 8.3 - 11.5. Combining Multiple Indexes"  rel="nofollow">8.3</a>
                    
                       / 
                      <a href="/docs/8.2/indexes-bitmap-scans.html" title="PostgreSQL 8.2 - 11.5. Combining Multiple Indexes"  rel="nofollow">8.2</a>
                    
                       / 
                      <a href="/docs/8.1/indexes-bitmap-scans.html" title="PostgreSQL 8.1 - 11.5. Combining Multiple Indexes"  rel="nofollow">8.1</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/13/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div>
              </form>
            </div>
          </div>

          <div id="docContent">
            <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">11.5.&nbsp;Combining Multiple Indexes</th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="indexes-ordering.html" title="11.4.&nbsp;Indexes and ORDER BY">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="indexes.html" title="Chapter&nbsp;11.&nbsp;Indexes">Up</a></td>
      <th width="60%" align="center">Chapter&nbsp;11.&nbsp;Indexes</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="indexes-unique.html" title="11.6.&nbsp;Unique Indexes">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="sect1" id="INDEXES-BITMAP-SCANS">
  <div class="titlepage">
    <div>
      <div>
        <h2 class="title" style="clear: both">11.5.&nbsp;Combining Multiple Indexes</h2>
      </div>
    </div>
  </div><a id="id-1.5.10.8.2" class="indexterm" name="id-1.5.10.8.2"></a><a id="id-1.5.10.8.3" class="indexterm" name="id-1.5.10.8.3"></a>
  <p>A single index scan can only use query clauses that use the index's columns with operators of its operator class and are joined with <code class="literal">AND</code>. For example, given an index on <code class="literal">(a, b)</code> a query condition like <code class="literal">WHERE a = 5 AND b = 6</code> could use the index, but a query like <code class="literal">WHERE a = 5 OR b = 6</code> could not directly use the index.</p>
  <p>Fortunately, <span class="productname">PostgreSQL</span> has the ability to combine multiple indexes (including multiple uses of the same index) to handle cases that cannot be implemented by single index scans. The system can form <code class="literal">AND</code> and <code class="literal">OR</code> conditions across several index scans. For example, a query like <code class="literal">WHERE x = 42 OR x = 47 OR x = 53 OR x = 99</code> could be broken down into four separate scans of an index on <code class="literal">x</code>, each scan using one of the query clauses. The results of these scans are then ORed together to produce the result. Another example is that if we have separate indexes on <code class="literal">x</code> and <code class="literal">y</code>, one possible implementation of a query like <code class="literal">WHERE x = 5 AND y = 6</code> is to use each index with the appropriate query clause and then AND together the index results to identify the result rows.</p>
  <p>To combine multiple indexes, the system scans each needed index and prepares a <em class="firstterm">bitmap</em> in memory giving the locations of table rows that are reported as matching that index's conditions. The bitmaps are then ANDed and ORed together as needed by the query. Finally, the actual table rows are visited and returned. The table rows are visited in physical order, because that is how the bitmap is laid out; this means that any ordering of the original indexes is lost, and so a separate sort step will be needed if the query has an <code class="literal">ORDER BY</code> clause. For this reason, and because each additional index scan adds extra time, the planner will sometimes choose to use a simple index scan even though additional indexes are available that could have been used as well.</p>
  <p>In all but the simplest applications, there are various combinations of indexes that might be useful, and the database developer must make trade-offs to decide which indexes to provide. Sometimes multicolumn indexes are best, but sometimes it's better to create separate indexes and rely on the index-combination feature. For example, if your workload includes a mix of queries that sometimes involve only column <code class="literal">x</code>, sometimes only column <code class="literal">y</code>, and sometimes both columns, you might choose to create two separate indexes on <code class="literal">x</code> and <code class="literal">y</code>, relying on index combination to process the queries that use both columns. You could also create a multicolumn index on <code class="literal">(x, y)</code>. This index would typically be more efficient than index combination for queries involving both columns, but as discussed in <a class="xref" href="indexes-multicolumn.html" title="11.3.&nbsp;Multicolumn Indexes">Section&nbsp;11.3</a>, it would be almost useless for queries involving only <code class="literal">y</code>, so it should not be the only index. A combination of the multicolumn index and a separate index on <code class="literal">y</code> would serve reasonably well. For queries involving only <code class="literal">x</code>, the multicolumn index could be used, though it would be larger and hence slower than an index on <code class="literal">x</code> alone. The last alternative is to create all three indexes, but this is probably only reasonable if the table is searched much more often than it is updated and all three types of query are common. If one of the types of query is much less common than the others, you'd probably settle for creating just the two indexes that best match the common types.</p>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="indexes-ordering.html" title="11.4.&nbsp;Indexes and ORDER BY">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="indexes.html" title="Chapter&nbsp;11.&nbsp;Indexes">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="indexes-unique.html" title="11.6.&nbsp;Unique Indexes">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">11.4.&nbsp;Indexes and <code xmlns="http://www.w3.org/1999/xhtml" class="literal">ORDER BY</code>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;11.6.&nbsp;Unique Indexes</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/13/indexes-bitmap-scans.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> 
      </div>
    </div>
    
    
    
    
    
    
  </body>
</html>
