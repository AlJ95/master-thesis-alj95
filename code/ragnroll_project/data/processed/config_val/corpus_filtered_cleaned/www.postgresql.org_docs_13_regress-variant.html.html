<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 13: 32.3. Variant Comparison Files</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/13/regress-variant.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-02-20T14:13:26" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="32.3. Variant Comparison Files" />
  <meta property="og:description" content="32.3.&amp;nbsp;Variant Comparison Files Since some of the tests inherently produce environment-dependent results, we have provided ways to specify alternate “expected” …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />


  

  
  
  
  
  

  

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          
          
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 20, 2025: <a href="/about/news/postgresql-174-168-1512-1417-and-1320-released-3018/">
  PostgreSQL 17.4, 16.8, 15.12, 14.17, and 13.20 Released!
</a>

</div>
      </div>
    </div>
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/13/index.html">PostgreSQL 13</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/regress-variant.html" title="PostgreSQL 17 - 32.3. Variant Comparison Files" >Current</a>
                          (<a href="/docs/17/regress-variant.html" title="PostgreSQL 17 - 32.3. Variant Comparison Files" >17</a>)
                        
                      
                         / 
                        
                          <a href="/docs/16/regress-variant.html" title="PostgreSQL 16 - 32.3. Variant Comparison Files" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/regress-variant.html" title="PostgreSQL 15 - 32.3. Variant Comparison Files" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/regress-variant.html" title="PostgreSQL 14 - 32.3. Variant Comparison Files" >14</a>
                        
                      
                         / 
                        
                          <a href="/docs/13/regress-variant.html" title="PostgreSQL 13 - 32.3. Variant Comparison Files" class="docs-version-selected">13</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/regress-variant.html" title="PostgreSQL devel - 32.3. Variant Comparison Files"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/12/regress-variant.html" title="PostgreSQL 12 - 32.3. Variant Comparison Files"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/regress-variant.html" title="PostgreSQL 11 - 32.3. Variant Comparison Files"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/regress-variant.html" title="PostgreSQL 10 - 32.3. Variant Comparison Files"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/regress-variant.html" title="PostgreSQL 9.6 - 32.3. Variant Comparison Files"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/regress-variant.html" title="PostgreSQL 9.5 - 32.3. Variant Comparison Files"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/regress-variant.html" title="PostgreSQL 9.4 - 32.3. Variant Comparison Files"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/regress-variant.html" title="PostgreSQL 9.3 - 32.3. Variant Comparison Files"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/regress-variant.html" title="PostgreSQL 9.2 - 32.3. Variant Comparison Files"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/regress-variant.html" title="PostgreSQL 9.1 - 32.3. Variant Comparison Files"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/regress-variant.html" title="PostgreSQL 9.0 - 32.3. Variant Comparison Files"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/regress-variant.html" title="PostgreSQL 8.4 - 32.3. Variant Comparison Files"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/regress-variant.html" title="PostgreSQL 8.3 - 32.3. Variant Comparison Files"  rel="nofollow">8.3</a>
                    
                       / 
                      <a href="/docs/8.2/regress-variant.html" title="PostgreSQL 8.2 - 32.3. Variant Comparison Files"  rel="nofollow">8.2</a>
                    
                       / 
                      <a href="/docs/8.1/regress-variant.html" title="PostgreSQL 8.1 - 32.3. Variant Comparison Files"  rel="nofollow">8.1</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/13/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div>
              </form>
            </div>
          </div>

          <div id="docContent">
            <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">32.3.&nbsp;Variant Comparison Files</th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="regress-evaluation.html" title="32.2.&nbsp;Test Evaluation">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="regress.html" title="Chapter&nbsp;32.&nbsp;Regression Tests">Up</a></td>
      <th width="60%" align="center">Chapter&nbsp;32.&nbsp;Regression Tests</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="regress-tap.html" title="32.4.&nbsp;TAP Tests">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="sect1" id="REGRESS-VARIANT">
  <div class="titlepage">
    <div>
      <div>
        <h2 class="title" style="clear: both">32.3.&nbsp;Variant Comparison Files</h2>
      </div>
    </div>
  </div>
  <p>Since some of the tests inherently produce environment-dependent results, we have provided ways to specify alternate <span class="quote">“<span class="quote">expected</span>”</span> result files. Each regression test can have several comparison files showing possible results on different platforms. There are two independent mechanisms for determining which comparison file is used for each test.</p>
  <p>The first mechanism allows comparison files to be selected for specific platforms. There is a mapping file, <code class="filename">src/test/regress/resultmap</code>, that defines which comparison file to use for each platform. To eliminate bogus test <span class="quote">“<span class="quote">failures</span>”</span> for a particular platform, you first choose or make a variant result file, and then add a line to the <code class="filename">resultmap</code> file.</p>
  <p>Each line in the mapping file is of the form</p>
  <pre class="synopsis">
testname:output:platformpattern=comparisonfilename
</pre>
  <p>The test name is just the name of the particular regression test module. The output value indicates which output file to check. For the standard regression tests, this is always <code class="literal">out</code>. The value corresponds to the file extension of the output file. The platform pattern is a pattern in the style of the Unix tool <code class="command">expr</code> (that is, a regular expression with an implicit <code class="literal">^</code> anchor at the start). It is matched against the platform name as printed by <code class="command">config.guess</code>. The comparison file name is the base name of the substitute result comparison file.</p>
  <p>For example: some systems lack a working <code class="literal">strtof</code> function, for which our workaround causes rounding errors in the <code class="filename">float4</code> regression test. Therefore, we provide a variant comparison file, <code class="filename">float4-misrounded-input.out</code>, which includes the results to be expected on these systems. To silence the bogus <span class="quote">“<span class="quote">failure</span>”</span> message on <span class="systemitem">HP-UX 10</span> platforms, <code class="filename">resultmap</code> includes:</p>
  <pre class="programlisting">
float4:out:hppa.*-hp-hpux10.*=float4-misrounded-input.out
</pre>
  <p>which will trigger on any machine where the output of <code class="command">config.guess</code> matches <code class="literal">hppa.*-hp-hpux10.*</code>. Other lines in <code class="filename">resultmap</code> select the variant comparison file for other platforms where it's appropriate.</p>
  <p>The second selection mechanism for variant comparison files is much more automatic: it simply uses the <span class="quote">“<span class="quote">best match</span>”</span> among several supplied comparison files. The regression test driver script considers both the standard comparison file for a test, <code class="literal"><em class="replaceable"><code>testname</code></em>.out</code>, and variant files named <code class="literal"><em class="replaceable"><code>testname</code></em>_<em class="replaceable"><code>digit</code></em>.out</code> (where the <em class="replaceable"><code>digit</code></em> is any single digit <code class="literal">0</code>-<code class="literal">9</code>). If any such file is an exact match, the test is considered to pass; otherwise, the one that generates the shortest diff is used to create the failure report. (If <code class="filename">resultmap</code> includes an entry for the particular test, then the base <em class="replaceable"><code>testname</code></em> is the substitute name given in <code class="filename">resultmap</code>.)</p>
  <p>For example, for the <code class="literal">char</code> test, the comparison file <code class="filename">char.out</code> contains results that are expected in the <code class="literal">C</code> and <code class="literal">POSIX</code> locales, while the file <code class="filename">char_1.out</code> contains results sorted as they appear in many other locales.</p>
  <p>The best-match mechanism was devised to cope with locale-dependent results, but it can be used in any situation where the test results cannot be predicted easily from the platform name alone. A limitation of this mechanism is that the test driver cannot tell which variant is actually <span class="quote">“<span class="quote">correct</span>”</span> for the current environment; it will just pick the variant that seems to work best. Therefore it is safest to use this mechanism only for variant results that you are willing to consider equally valid in all contexts.</p>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="regress-evaluation.html" title="32.2.&nbsp;Test Evaluation">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="regress.html" title="Chapter&nbsp;32.&nbsp;Regression Tests">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="regress-tap.html" title="32.4.&nbsp;TAP Tests">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">32.2.&nbsp;Test Evaluation&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;32.4.&nbsp;TAP Tests</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/13/regress-variant.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> 
      </div>
    </div>
    
    
    
    
    
    
  </body>
</html>
