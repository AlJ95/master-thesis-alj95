<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 13: 33.6. Canceling Queries in Progress</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/13/libpq-cancel.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-02-20T14:13:26" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="33.6. Canceling Queries in Progress" />
  <meta property="og:description" content="33.6.&amp;nbsp;Canceling Queries in Progress A client application can request cancellation of a command that is still being processed by the …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />


  

  
  
  
  
  

  

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          
          
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 20, 2025: <a href="/about/news/postgresql-174-168-1512-1417-and-1320-released-3018/">
  PostgreSQL 17.4, 16.8, 15.12, 14.17, and 13.20 Released!
</a>

</div>
      </div>
    </div>
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/13/index.html">PostgreSQL 13</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/libpq-cancel.html" title="PostgreSQL 17 - 33.6. Canceling Queries in Progress" >Current</a>
                          (<a href="/docs/17/libpq-cancel.html" title="PostgreSQL 17 - 33.6. Canceling Queries in Progress" >17</a>)
                        
                      
                         / 
                        
                          <a href="/docs/16/libpq-cancel.html" title="PostgreSQL 16 - 33.6. Canceling Queries in Progress" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/libpq-cancel.html" title="PostgreSQL 15 - 33.6. Canceling Queries in Progress" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/libpq-cancel.html" title="PostgreSQL 14 - 33.6. Canceling Queries in Progress" >14</a>
                        
                      
                         / 
                        
                          <a href="/docs/13/libpq-cancel.html" title="PostgreSQL 13 - 33.6. Canceling Queries in Progress" class="docs-version-selected">13</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/libpq-cancel.html" title="PostgreSQL devel - 33.6. Canceling Queries in Progress"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/12/libpq-cancel.html" title="PostgreSQL 12 - 33.6. Canceling Queries in Progress"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/libpq-cancel.html" title="PostgreSQL 11 - 33.6. Canceling Queries in Progress"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/libpq-cancel.html" title="PostgreSQL 10 - 33.6. Canceling Queries in Progress"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/libpq-cancel.html" title="PostgreSQL 9.6 - 33.6. Canceling Queries in Progress"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/libpq-cancel.html" title="PostgreSQL 9.5 - 33.6. Canceling Queries in Progress"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/libpq-cancel.html" title="PostgreSQL 9.4 - 33.6. Canceling Queries in Progress"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/libpq-cancel.html" title="PostgreSQL 9.3 - 33.6. Canceling Queries in Progress"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/libpq-cancel.html" title="PostgreSQL 9.2 - 33.6. Canceling Queries in Progress"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/libpq-cancel.html" title="PostgreSQL 9.1 - 33.6. Canceling Queries in Progress"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/libpq-cancel.html" title="PostgreSQL 9.0 - 33.6. Canceling Queries in Progress"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/libpq-cancel.html" title="PostgreSQL 8.4 - 33.6. Canceling Queries in Progress"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/libpq-cancel.html" title="PostgreSQL 8.3 - 33.6. Canceling Queries in Progress"  rel="nofollow">8.3</a>
                    
                       / 
                      <a href="/docs/8.2/libpq-cancel.html" title="PostgreSQL 8.2 - 33.6. Canceling Queries in Progress"  rel="nofollow">8.2</a>
                    
                       / 
                      <a href="/docs/8.1/libpq-cancel.html" title="PostgreSQL 8.1 - 33.6. Canceling Queries in Progress"  rel="nofollow">8.1</a>
                    
                       / 
                      <a href="/docs/8.0/libpq-cancel.html" title="PostgreSQL 8.0 - 33.6. Canceling Queries in Progress"  rel="nofollow">8.0</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/13/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div>
              </form>
            </div>
          </div>

          <div id="docContent">
            <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">33.6.&nbsp;Canceling Queries in Progress</th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="libpq-single-row-mode.html" title="33.5.&nbsp;Retrieving Query Results Row-by-Row">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="libpq.html" title="Chapter&nbsp;33.&nbsp;libpq — C Library">Up</a></td>
      <th width="60%" align="center">Chapter&nbsp;33.&nbsp;<span xmlns="http://www.w3.org/1999/xhtml" class="application">libpq</span> — C Library</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="libpq-fastpath.html" title="33.7.&nbsp;The Fast-Path Interface">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="sect1" id="LIBPQ-CANCEL">
  <div class="titlepage">
    <div>
      <div>
        <h2 class="title" style="clear: both">33.6.&nbsp;Canceling Queries in Progress</h2>
      </div>
    </div>
  </div><a id="id-1.7.3.13.2" class="indexterm" name="id-1.7.3.13.2"></a>
  <p>A client application can request cancellation of a command that is still being processed by the server, using the functions described in this section.</p>
  <div class="variablelist">
    <dl class="variablelist">
      <dt id="LIBPQ-PQGETCANCEL"><span class="term"><code class="function">PQgetCancel</code><a id="id-1.7.3.13.3.1.1.1.2" class="indexterm" name="id-1.7.3.13.3.1.1.1.2"></a></span></dt>
      <dd>
        <p>Creates a data structure containing the information needed to cancel a command issued through a particular database connection.</p>
        <pre class="synopsis">
PGcancel *PQgetCancel(PGconn *conn);
</pre>
        <p><a class="xref" href="libpq-cancel.html#LIBPQ-PQGETCANCEL"><code class="function">PQgetCancel</code></a> creates a <code class="structname">PGcancel</code><a id="id-1.7.3.13.3.1.1.2.2.3" class="indexterm" name="id-1.7.3.13.3.1.1.2.2.3"></a> object given a <code class="structname">PGconn</code> connection object. It will return <code class="symbol">NULL</code> if the given <em class="parameter"><code>conn</code></em> is <code class="symbol">NULL</code> or an invalid connection. The <code class="structname">PGcancel</code> object is an opaque structure that is not meant to be accessed directly by the application; it can only be passed to <a class="xref" href="libpq-cancel.html#LIBPQ-PQCANCEL"><code class="function">PQcancel</code></a> or <a class="xref" href="libpq-cancel.html#LIBPQ-PQFREECANCEL"><code class="function">PQfreeCancel</code></a>.</p>
      </dd>
      <dt id="LIBPQ-PQFREECANCEL"><span class="term"><code class="function">PQfreeCancel</code><a id="id-1.7.3.13.3.1.2.1.2" class="indexterm" name="id-1.7.3.13.3.1.2.1.2"></a></span></dt>
      <dd>
        <p>Frees a data structure created by <a class="xref" href="libpq-cancel.html#LIBPQ-PQGETCANCEL"><code class="function">PQgetCancel</code></a>.</p>
        <pre class="synopsis">
void PQfreeCancel(PGcancel *cancel);
</pre>
        <p><a class="xref" href="libpq-cancel.html#LIBPQ-PQFREECANCEL"><code class="function">PQfreeCancel</code></a> frees a data object previously created by <a class="xref" href="libpq-cancel.html#LIBPQ-PQGETCANCEL"><code class="function">PQgetCancel</code></a>.</p>
      </dd>
      <dt id="LIBPQ-PQCANCEL"><span class="term"><code class="function">PQcancel</code><a id="id-1.7.3.13.3.1.3.1.2" class="indexterm" name="id-1.7.3.13.3.1.3.1.2"></a></span></dt>
      <dd>
        <p>Requests that the server abandon processing of the current command.</p>
        <pre class="synopsis">
int PQcancel(PGcancel *cancel, char *errbuf, int errbufsize);
</pre>
        <p>The return value is 1 if the cancel request was successfully dispatched and 0 if not. If not, <em class="parameter"><code>errbuf</code></em> is filled with an explanatory error message. <em class="parameter"><code>errbuf</code></em> must be a char array of size <em class="parameter"><code>errbufsize</code></em> (the recommended size is 256 bytes).</p>
        <p>Successful dispatch is no guarantee that the request will have any effect, however. If the cancellation is effective, the current command will terminate early and return an error result. If the cancellation fails (say, because the server was already done processing the command), then there will be no visible result at all.</p>
        <p><a class="xref" href="libpq-cancel.html#LIBPQ-PQCANCEL"><code class="function">PQcancel</code></a> can safely be invoked from a signal handler, if the <em class="parameter"><code>errbuf</code></em> is a local variable in the signal handler. The <code class="structname">PGcancel</code> object is read-only as far as <a class="xref" href="libpq-cancel.html#LIBPQ-PQCANCEL"><code class="function">PQcancel</code></a> is concerned, so it can also be invoked from a thread that is separate from the one manipulating the <code class="structname">PGconn</code> object.</p>
      </dd>
    </dl>
  </div>
  <div class="variablelist">
    <dl class="variablelist">
      <dt id="LIBPQ-PQREQUESTCANCEL"><span class="term"><code class="function">PQrequestCancel</code><a id="id-1.7.3.13.3.2.1.1.2" class="indexterm" name="id-1.7.3.13.3.2.1.1.2"></a></span></dt>
      <dd>
        <p><a class="xref" href="libpq-cancel.html#LIBPQ-PQREQUESTCANCEL"><code class="function">PQrequestCancel</code></a> is a deprecated variant of <a class="xref" href="libpq-cancel.html#LIBPQ-PQCANCEL"><code class="function">PQcancel</code></a>.</p>
        <pre class="synopsis">
int PQrequestCancel(PGconn *conn);
</pre>
        <p>Requests that the server abandon processing of the current command. It operates directly on the <code class="structname">PGconn</code> object, and in case of failure stores the error message in the <code class="structname">PGconn</code> object (whence it can be retrieved by <a class="xref" href="libpq-status.html#LIBPQ-PQERRORMESSAGE"><code class="function">PQerrorMessage</code></a>). Although the functionality is the same, this approach creates hazards for multiple-thread programs and signal handlers, since it is possible that overwriting the <code class="structname">PGconn</code>'s error message will mess up the operation currently in progress on the connection.</p>
      </dd>
    </dl>
  </div>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="libpq-single-row-mode.html" title="33.5.&nbsp;Retrieving Query Results Row-by-Row">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="libpq.html" title="Chapter&nbsp;33.&nbsp;libpq — C Library">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="libpq-fastpath.html" title="33.7.&nbsp;The Fast-Path Interface">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">33.5.&nbsp;Retrieving Query Results Row-by-Row&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;33.7.&nbsp;The Fast-Path Interface</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/13/libpq-cancel.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> 
      </div>
    </div>
    
    
    
    
    
    
  </body>
</html>
