<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 13: 29.3. Asynchronous Commit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/13/wal-async-commit.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-02-20T14:13:26" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="29.3. Asynchronous Commit" />
  <meta property="og:description" content="29.3.&amp;nbsp;Asynchronous Commit Asynchronous commit is an option that allows transactions to complete more quickly, at the cost that the most …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />


  

  
  
  
  
  

  

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          
          
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 20, 2025: <a href="/about/news/postgresql-174-168-1512-1417-and-1320-released-3018/">
  PostgreSQL 17.4, 16.8, 15.12, 14.17, and 13.20 Released!
</a>

</div>
      </div>
    </div>
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/13/index.html">PostgreSQL 13</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/wal-async-commit.html" title="PostgreSQL 17 - 29.3. Asynchronous Commit" >Current</a>
                          (<a href="/docs/17/wal-async-commit.html" title="PostgreSQL 17 - 29.3. Asynchronous Commit" >17</a>)
                        
                      
                         / 
                        
                          <a href="/docs/16/wal-async-commit.html" title="PostgreSQL 16 - 29.3. Asynchronous Commit" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/wal-async-commit.html" title="PostgreSQL 15 - 29.3. Asynchronous Commit" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/wal-async-commit.html" title="PostgreSQL 14 - 29.3. Asynchronous Commit" >14</a>
                        
                      
                         / 
                        
                          <a href="/docs/13/wal-async-commit.html" title="PostgreSQL 13 - 29.3. Asynchronous Commit" class="docs-version-selected">13</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/wal-async-commit.html" title="PostgreSQL devel - 29.3. Asynchronous Commit"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/12/wal-async-commit.html" title="PostgreSQL 12 - 29.3. Asynchronous Commit"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/wal-async-commit.html" title="PostgreSQL 11 - 29.3. Asynchronous Commit"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/wal-async-commit.html" title="PostgreSQL 10 - 29.3. Asynchronous Commit"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/wal-async-commit.html" title="PostgreSQL 9.6 - 29.3. Asynchronous Commit"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/wal-async-commit.html" title="PostgreSQL 9.5 - 29.3. Asynchronous Commit"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/wal-async-commit.html" title="PostgreSQL 9.4 - 29.3. Asynchronous Commit"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/wal-async-commit.html" title="PostgreSQL 9.3 - 29.3. Asynchronous Commit"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/wal-async-commit.html" title="PostgreSQL 9.2 - 29.3. Asynchronous Commit"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/wal-async-commit.html" title="PostgreSQL 9.1 - 29.3. Asynchronous Commit"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/wal-async-commit.html" title="PostgreSQL 9.0 - 29.3. Asynchronous Commit"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/wal-async-commit.html" title="PostgreSQL 8.4 - 29.3. Asynchronous Commit"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/wal-async-commit.html" title="PostgreSQL 8.3 - 29.3. Asynchronous Commit"  rel="nofollow">8.3</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/13/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div>
              </form>
            </div>
          </div>

          <div id="docContent">
            <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">29.3.&nbsp;Asynchronous Commit</th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="wal-intro.html" title="29.2.&nbsp;Write-Ahead Logging (WAL)">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="wal.html" title="Chapter&nbsp;29.&nbsp;Reliability and the Write-Ahead Log">Up</a></td>
      <th width="60%" align="center">Chapter&nbsp;29.&nbsp;Reliability and the Write-Ahead Log</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="wal-configuration.html" title="29.4.&nbsp;WAL Configuration">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="sect1" id="WAL-ASYNC-COMMIT">
  <div class="titlepage">
    <div>
      <div>
        <h2 class="title" style="clear: both">29.3.&nbsp;Asynchronous Commit</h2>
      </div>
    </div>
  </div><a id="id-1.6.16.5.2" class="indexterm" name="id-1.6.16.5.2"></a><a id="id-1.6.16.5.3" class="indexterm" name="id-1.6.16.5.3"></a>
  <p><em class="firstterm">Asynchronous commit</em> is an option that allows transactions to complete more quickly, at the cost that the most recent transactions may be lost if the database should crash. In many applications this is an acceptable trade-off.</p>
  <p>As described in the previous section, transaction commit is normally <em class="firstterm">synchronous</em>: the server waits for the transaction's <acronym class="acronym">WAL</acronym> records to be flushed to permanent storage before returning a success indication to the client. The client is therefore guaranteed that a transaction reported to be committed will be preserved, even in the event of a server crash immediately after. However, for short transactions this delay is a major component of the total transaction time. Selecting asynchronous commit mode means that the server returns success as soon as the transaction is logically completed, before the <acronym class="acronym">WAL</acronym> records it generated have actually made their way to disk. This can provide a significant boost in throughput for small transactions.</p>
  <p>Asynchronous commit introduces the risk of data loss. There is a short time window between the report of transaction completion to the client and the time that the transaction is truly committed (that is, it is guaranteed not to be lost if the server crashes). Thus asynchronous commit should not be used if the client will take external actions relying on the assumption that the transaction will be remembered. As an example, a bank would certainly not use asynchronous commit for a transaction recording an ATM's dispensing of cash. But in many scenarios, such as event logging, there is no need for a strong guarantee of this kind.</p>
  <p>The risk that is taken by using asynchronous commit is of data loss, not data corruption. If the database should crash, it will recover by replaying <acronym class="acronym">WAL</acronym> up to the last record that was flushed. The database will therefore be restored to a self-consistent state, but any transactions that were not yet flushed to disk will not be reflected in that state. The net effect is therefore loss of the last few transactions. Because the transactions are replayed in commit order, no inconsistency can be introduced — for example, if transaction B made changes relying on the effects of a previous transaction A, it is not possible for A's effects to be lost while B's effects are preserved.</p>
  <p>The user can select the commit mode of each transaction, so that it is possible to have both synchronous and asynchronous commit transactions running concurrently. This allows flexible trade-offs between performance and certainty of transaction durability. The commit mode is controlled by the user-settable parameter <a class="xref" href="runtime-config-wal.html#GUC-SYNCHRONOUS-COMMIT">synchronous_commit</a>, which can be changed in any of the ways that a configuration parameter can be set. The mode used for any one transaction depends on the value of <code class="varname">synchronous_commit</code> when transaction commit begins.</p>
  <p>Certain utility commands, for instance <code class="command">DROP TABLE</code>, are forced to commit synchronously regardless of the setting of <code class="varname">synchronous_commit</code>. This is to ensure consistency between the server's file system and the logical state of the database. The commands supporting two-phase commit, such as <code class="command">PREPARE TRANSACTION</code>, are also always synchronous.</p>
  <p>If the database crashes during the risk window between an asynchronous commit and the writing of the transaction's <acronym class="acronym">WAL</acronym> records, then changes made during that transaction <span class="emphasis"><em>will</em></span> be lost. The duration of the risk window is limited because a background process (the <span class="quote">“<span class="quote">WAL writer</span>”</span>) flushes unwritten <acronym class="acronym">WAL</acronym> records to disk every <a class="xref" href="runtime-config-wal.html#GUC-WAL-WRITER-DELAY">wal_writer_delay</a> milliseconds. The actual maximum duration of the risk window is three times <code class="varname">wal_writer_delay</code> because the WAL writer is designed to favor writing whole pages at a time during busy periods.</p>
  <div class="caution">
    <h3 class="title">Caution</h3>
    <p>An immediate-mode shutdown is equivalent to a server crash, and will therefore cause loss of any unflushed asynchronous commits.</p>
  </div>
  <p>Asynchronous commit provides behavior different from setting <a class="xref" href="runtime-config-wal.html#GUC-FSYNC">fsync</a> = off. <code class="varname">fsync</code> is a server-wide setting that will alter the behavior of all transactions. It disables all logic within <span class="productname">PostgreSQL</span> that attempts to synchronize writes to different portions of the database, and therefore a system crash (that is, a hardware or operating system crash, not a failure of <span class="productname">PostgreSQL</span> itself) could result in arbitrarily bad corruption of the database state. In many scenarios, asynchronous commit provides most of the performance improvement that could be obtained by turning off <code class="varname">fsync</code>, but without the risk of data corruption.</p>
  <p><a class="xref" href="runtime-config-wal.html#GUC-COMMIT-DELAY">commit_delay</a> also sounds very similar to asynchronous commit, but it is actually a synchronous commit method (in fact, <code class="varname">commit_delay</code> is ignored during an asynchronous commit). <code class="varname">commit_delay</code> causes a delay just before a transaction flushes <acronym class="acronym">WAL</acronym> to disk, in the hope that a single flush executed by one such transaction can also serve other transactions committing at about the same time. The setting can be thought of as a way of increasing the time window in which transactions can join a group about to participate in a single flush, to amortize the cost of the flush among multiple transactions.</p>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="wal-intro.html" title="29.2.&nbsp;Write-Ahead Logging (WAL)">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="wal.html" title="Chapter&nbsp;29.&nbsp;Reliability and the Write-Ahead Log">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="wal-configuration.html" title="29.4.&nbsp;WAL Configuration">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">29.2.&nbsp;Write-Ahead Logging (<acronym xmlns="http://www.w3.org/1999/xhtml" class="acronym">WAL</acronym>)&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;29.4.&nbsp;<acronym xmlns="http://www.w3.org/1999/xhtml" class="acronym">WAL</acronym> Configuration</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/13/wal-async-commit.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> 
      </div>
    </div>
    
    
    
    
    
    
  </body>
</html>
