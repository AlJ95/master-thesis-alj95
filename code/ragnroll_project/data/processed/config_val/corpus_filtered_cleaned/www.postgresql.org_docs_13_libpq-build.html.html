<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 13: 33.20. Building libpq Programs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/13/libpq-build.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-02-20T14:13:26" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="33.20. Building libpq Programs" />
  <meta property="og:description" content="33.20.&amp;nbsp;Building libpq Programs To build (i.e., compile and link) a program using libpq you need to do all of the …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />


  

  
  
  
  
  

  

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          
          
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 20, 2025: <a href="/about/news/postgresql-174-168-1512-1417-and-1320-released-3018/">
  PostgreSQL 17.4, 16.8, 15.12, 14.17, and 13.20 Released!
</a>

</div>
      </div>
    </div>
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/13/index.html">PostgreSQL 13</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/libpq-build.html" title="PostgreSQL 17 - 33.20. Building libpq Programs" >Current</a>
                          (<a href="/docs/17/libpq-build.html" title="PostgreSQL 17 - 33.20. Building libpq Programs" >17</a>)
                        
                      
                         / 
                        
                          <a href="/docs/16/libpq-build.html" title="PostgreSQL 16 - 33.20. Building libpq Programs" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/libpq-build.html" title="PostgreSQL 15 - 33.20. Building libpq Programs" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/libpq-build.html" title="PostgreSQL 14 - 33.20. Building libpq Programs" >14</a>
                        
                      
                         / 
                        
                          <a href="/docs/13/libpq-build.html" title="PostgreSQL 13 - 33.20. Building libpq Programs" class="docs-version-selected">13</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/libpq-build.html" title="PostgreSQL devel - 33.20. Building libpq Programs"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/12/libpq-build.html" title="PostgreSQL 12 - 33.20. Building libpq Programs"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/libpq-build.html" title="PostgreSQL 11 - 33.20. Building libpq Programs"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/libpq-build.html" title="PostgreSQL 10 - 33.20. Building libpq Programs"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/libpq-build.html" title="PostgreSQL 9.6 - 33.20. Building libpq Programs"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/libpq-build.html" title="PostgreSQL 9.5 - 33.20. Building libpq Programs"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/libpq-build.html" title="PostgreSQL 9.4 - 33.20. Building libpq Programs"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/libpq-build.html" title="PostgreSQL 9.3 - 33.20. Building libpq Programs"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/libpq-build.html" title="PostgreSQL 9.2 - 33.20. Building libpq Programs"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/libpq-build.html" title="PostgreSQL 9.1 - 33.20. Building libpq Programs"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/libpq-build.html" title="PostgreSQL 9.0 - 33.20. Building libpq Programs"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/libpq-build.html" title="PostgreSQL 8.4 - 33.20. Building libpq Programs"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/libpq-build.html" title="PostgreSQL 8.3 - 33.20. Building libpq Programs"  rel="nofollow">8.3</a>
                    
                       / 
                      <a href="/docs/8.2/libpq-build.html" title="PostgreSQL 8.2 - 33.20. Building libpq Programs"  rel="nofollow">8.2</a>
                    
                       / 
                      <a href="/docs/8.1/libpq-build.html" title="PostgreSQL 8.1 - 33.20. Building libpq Programs"  rel="nofollow">8.1</a>
                    
                       / 
                      <a href="/docs/8.0/libpq-build.html" title="PostgreSQL 8.0 - 33.20. Building libpq Programs"  rel="nofollow">8.0</a>
                    
                       / 
                      <a href="/docs/7.4/libpq-build.html" title="PostgreSQL 7.4 - 33.20. Building libpq Programs"  rel="nofollow">7.4</a>
                    
                       / 
                      <a href="/docs/7.3/libpq-build.html" title="PostgreSQL 7.3 - 33.20. Building libpq Programs"  rel="nofollow">7.3</a>
                    
                       / 
                      <a href="/docs/7.2/libpq-build.html" title="PostgreSQL 7.2 - 33.20. Building libpq Programs"  rel="nofollow">7.2</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/13/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div>
              </form>
            </div>
          </div>

          <div id="docContent">
            <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">33.20.&nbsp;Building <span xmlns="http://www.w3.org/1999/xhtml" class="application">libpq</span> Programs</th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="libpq-threading.html" title="33.19.&nbsp;Behavior in Threaded Programs">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="libpq.html" title="Chapter&nbsp;33.&nbsp;libpq — C Library">Up</a></td>
      <th width="60%" align="center">Chapter&nbsp;33.&nbsp;<span xmlns="http://www.w3.org/1999/xhtml" class="application">libpq</span> — C Library</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="libpq-example.html" title="33.21.&nbsp;Example Programs">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="sect1" id="LIBPQ-BUILD">
  <div class="titlepage">
    <div>
      <div>
        <h2 class="title" style="clear: both">33.20.&nbsp;Building <span class="application">libpq</span> Programs</h2>
      </div>
    </div>
  </div><a id="id-1.7.3.27.2" class="indexterm" name="id-1.7.3.27.2"></a>
  <p>To build (i.e., compile and link) a program using <span class="application">libpq</span> you need to do all of the following things:</p>
  <div class="itemizedlist">
    <ul class="itemizedlist" style="list-style-type: disc;">
      <li class="listitem">
        <p>Include the <code class="filename">libpq-fe.h</code> header file:</p>
        <pre class="programlisting">
#include &lt;libpq-fe.h&gt;
</pre>
        <p>If you failed to do that then you will normally get error messages from your compiler similar to:</p>
        <pre class="screen">
foo.c: In function `main':
foo.c:34: `PGconn' undeclared (first use in this function)
foo.c:35: `PGresult' undeclared (first use in this function)
foo.c:54: `CONNECTION_BAD' undeclared (first use in this function)
foo.c:68: `PGRES_COMMAND_OK' undeclared (first use in this function)
foo.c:95: `PGRES_TUPLES_OK' undeclared (first use in this function)
</pre>
      </li>
      <li class="listitem">
        <p>Point your compiler to the directory where the <span class="productname">PostgreSQL</span> header files were installed, by supplying the <code class="literal">-I<em class="replaceable"><code>directory</code></em></code> option to your compiler. (In some cases the compiler will look into the directory in question by default, so you can omit this option.) For instance, your compile command line could look like:</p>
        <pre class="programlisting">
cc -c -I/usr/local/pgsql/include testprog.c
</pre>
        <p>If you are using makefiles then add the option to the <code class="varname">CPPFLAGS</code> variable:</p>
        <pre class="programlisting">
CPPFLAGS += -I/usr/local/pgsql/include
</pre>
        <p>If there is any chance that your program might be compiled by other users then you should not hardcode the directory location like that. Instead, you can run the utility <code class="command">pg_config</code><a id="id-1.7.3.27.3.2.2.2.2" class="indexterm" name="id-1.7.3.27.3.2.2.2.2"></a> to find out where the header files are on the local system:</p>
        <pre class="screen">
<code class="prompt">$</code> pg_config --includedir
<code class="computeroutput">/usr/local/include</code>
</pre>
        <p>If you have <code class="command">pkg-config</code><a id="id-1.7.3.27.3.2.2.3.2" class="indexterm" name="id-1.7.3.27.3.2.2.3.2"></a> installed, you can run instead:</p>
        <pre class="screen">
<code class="prompt">$</code> pkg-config --cflags libpq
<code class="computeroutput">-I/usr/local/include</code>
</pre>
        <p>Note that this will already include the <code class="option">-I</code> in front of the path.</p>
        <p>Failure to specify the correct option to the compiler will result in an error message such as:</p>
        <pre class="screen">
testlibpq.c:8:22: libpq-fe.h: No such file or directory
</pre>
      </li>
      <li class="listitem">
        <p>When linking the final program, specify the option <code class="literal">-lpq</code> so that the <span class="application">libpq</span> library gets pulled in, as well as the option <code class="literal">-L<em class="replaceable"><code>directory</code></em></code> to point the compiler to the directory where the <span class="application">libpq</span> library resides. (Again, the compiler will search some directories by default.) For maximum portability, put the <code class="option">-L</code> option before the <code class="option">-lpq</code> option. For example:</p>
        <pre class="programlisting">
cc -o testprog testprog1.o testprog2.o -L/usr/local/pgsql/lib -lpq
</pre>
        <p>You can find out the library directory using <code class="command">pg_config</code> as well:</p>
        <pre class="screen">
<code class="prompt">$</code> pg_config --libdir
<code class="computeroutput">/usr/local/pgsql/lib</code>
</pre>
        <p>Or again use <code class="command">pkg-config</code>:</p>
        <pre class="screen">
<code class="prompt">$</code> pkg-config --libs libpq
<code class="computeroutput">-L/usr/local/pgsql/lib -lpq</code>
</pre>
        <p>Note again that this prints the full options, not only the path.</p>
        <p>Error messages that point to problems in this area could look like the following:</p>
        <pre class="screen">
testlibpq.o: In function `main':
testlibpq.o(.text+0x60): undefined reference to `PQsetdbLogin'
testlibpq.o(.text+0x71): undefined reference to `PQstatus'
testlibpq.o(.text+0xa4): undefined reference to `PQerrorMessage'
</pre>
        <p>This means you forgot <code class="option">-lpq</code>.</p>
        <pre class="screen">
/usr/bin/ld: cannot find -lpq
</pre>
        <p>This means you forgot the <code class="option">-L</code> option or did not specify the right directory.</p>
      </li>
    </ul>
  </div>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="libpq-threading.html" title="33.19.&nbsp;Behavior in Threaded Programs">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="libpq.html" title="Chapter&nbsp;33.&nbsp;libpq — C Library">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="libpq-example.html" title="33.21.&nbsp;Example Programs">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">33.19.&nbsp;Behavior in Threaded Programs&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;33.21.&nbsp;Example Programs</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/13/libpq-build.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> 
      </div>
    </div>
    
    
    
    
    
    
  </body>
</html>
