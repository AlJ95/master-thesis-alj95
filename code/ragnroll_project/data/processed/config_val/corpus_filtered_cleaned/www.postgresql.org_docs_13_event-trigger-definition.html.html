<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 13: 39.1. Overview of Event Trigger Behavior</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/13/event-trigger-definition.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-02-20T14:13:26" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="39.1. Overview of Event Trigger Behavior" />
  <meta property="og:description" content="39.1.&amp;nbsp;Overview of Event Trigger Behavior An event trigger fires whenever the event with which it is associated occurs in the …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />


  

  
  
  
  
  

  

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          
          
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 20, 2025: <a href="/about/news/postgresql-174-168-1512-1417-and-1320-released-3018/">
  PostgreSQL 17.4, 16.8, 15.12, 14.17, and 13.20 Released!
</a>

</div>
      </div>
    </div>
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/13/index.html">PostgreSQL 13</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/event-trigger-definition.html" title="PostgreSQL 17 - 39.1. Overview of Event Trigger Behavior" >Current</a>
                          (<a href="/docs/17/event-trigger-definition.html" title="PostgreSQL 17 - 39.1. Overview of Event Trigger Behavior" >17</a>)
                        
                      
                         / 
                        
                          <a href="/docs/16/event-trigger-definition.html" title="PostgreSQL 16 - 39.1. Overview of Event Trigger Behavior" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/event-trigger-definition.html" title="PostgreSQL 15 - 39.1. Overview of Event Trigger Behavior" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/event-trigger-definition.html" title="PostgreSQL 14 - 39.1. Overview of Event Trigger Behavior" >14</a>
                        
                      
                         / 
                        
                          <a href="/docs/13/event-trigger-definition.html" title="PostgreSQL 13 - 39.1. Overview of Event Trigger Behavior" class="docs-version-selected">13</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/event-trigger-definition.html" title="PostgreSQL devel - 39.1. Overview of Event Trigger Behavior"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/12/event-trigger-definition.html" title="PostgreSQL 12 - 39.1. Overview of Event Trigger Behavior"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/event-trigger-definition.html" title="PostgreSQL 11 - 39.1. Overview of Event Trigger Behavior"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/event-trigger-definition.html" title="PostgreSQL 10 - 39.1. Overview of Event Trigger Behavior"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/event-trigger-definition.html" title="PostgreSQL 9.6 - 39.1. Overview of Event Trigger Behavior"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/event-trigger-definition.html" title="PostgreSQL 9.5 - 39.1. Overview of Event Trigger Behavior"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/event-trigger-definition.html" title="PostgreSQL 9.4 - 39.1. Overview of Event Trigger Behavior"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/event-trigger-definition.html" title="PostgreSQL 9.3 - 39.1. Overview of Event Trigger Behavior"  rel="nofollow">9.3</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/13/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div>
              </form>
            </div>
          </div>

          <div id="docContent">
            <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">39.1.&nbsp;Overview of Event Trigger Behavior</th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="event-triggers.html" title="Chapter&nbsp;39.&nbsp;Event Triggers">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="event-triggers.html" title="Chapter&nbsp;39.&nbsp;Event Triggers">Up</a></td>
      <th width="60%" align="center">Chapter&nbsp;39.&nbsp;Event Triggers</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="event-trigger-matrix.html" title="39.2.&nbsp;Event Trigger Firing Matrix">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="sect1" id="EVENT-TRIGGER-DEFINITION">
  <div class="titlepage">
    <div>
      <div>
        <h2 class="title" style="clear: both">39.1.&nbsp;Overview of Event Trigger Behavior</h2>
      </div>
    </div>
  </div>
  <p>An event trigger fires whenever the event with which it is associated occurs in the database in which it is defined. Currently, the only supported events are <code class="literal">ddl_command_start</code>, <code class="literal">ddl_command_end</code>, <code class="literal">table_rewrite</code> and <code class="literal">sql_drop</code>. Support for additional events may be added in future releases.</p>
  <p>The <code class="literal">ddl_command_start</code> event occurs just before the execution of a <code class="literal">CREATE</code>, <code class="literal">ALTER</code>, <code class="literal">DROP</code>, <code class="literal">SECURITY LABEL</code>, <code class="literal">COMMENT</code>, <code class="literal">GRANT</code> or <code class="literal">REVOKE</code> command. No check whether the affected object exists or doesn't exist is performed before the event trigger fires. As an exception, however, this event does not occur for DDL commands targeting shared objects — databases, roles, and tablespaces — or for commands targeting event triggers themselves. The event trigger mechanism does not support these object types. <code class="literal">ddl_command_start</code> also occurs just before the execution of a <code class="literal">SELECT INTO</code> command, since this is equivalent to <code class="literal">CREATE TABLE AS</code>.</p>
  <p>The <code class="literal">ddl_command_end</code> event occurs just after the execution of this same set of commands. To obtain more details on the <acronym class="acronym">DDL</acronym> operations that took place, use the set-returning function <code class="literal">pg_event_trigger_ddl_commands()</code> from the <code class="literal">ddl_command_end</code> event trigger code (see <a class="xref" href="functions-event-triggers.html" title="9.29.&nbsp;Event Trigger Functions">Section&nbsp;9.29</a>). Note that the trigger fires after the actions have taken place (but before the transaction commits), and thus the system catalogs can be read as already changed.</p>
  <p>The <code class="literal">sql_drop</code> event occurs just before the <code class="literal">ddl_command_end</code> event trigger for any operation that drops database objects. To list the objects that have been dropped, use the set-returning function <code class="literal">pg_event_trigger_dropped_objects()</code> from the <code class="literal">sql_drop</code> event trigger code (see <a class="xref" href="functions-event-triggers.html" title="9.29.&nbsp;Event Trigger Functions">Section&nbsp;9.29</a>). Note that the trigger is executed after the objects have been deleted from the system catalogs, so it's not possible to look them up anymore.</p>
  <p>The <code class="literal">table_rewrite</code> event occurs just before a table is rewritten by some actions of the commands <code class="literal">ALTER TABLE</code> and <code class="literal">ALTER TYPE</code>. While other control statements are available to rewrite a table, like <code class="literal">CLUSTER</code> and <code class="literal">VACUUM</code>, the <code class="literal">table_rewrite</code> event is not triggered by them. To find the OID of the table that was rewritten, use the function <code class="literal">pg_event_trigger_table_rewrite_oid()</code> (see <a class="xref" href="functions-event-triggers.html" title="9.29.&nbsp;Event Trigger Functions">Section&nbsp;9.29</a>). To discover the reason(s) for the rewrite, use the function <code class="literal">pg_event_trigger_table_rewrite_reason()</code>.</p>
  <p>Event triggers (like other functions) cannot be executed in an aborted transaction. Thus, if a DDL command fails with an error, any associated <code class="literal">ddl_command_end</code> triggers will not be executed. Conversely, if a <code class="literal">ddl_command_start</code> trigger fails with an error, no further event triggers will fire, and no attempt will be made to execute the command itself. Similarly, if a <code class="literal">ddl_command_end</code> trigger fails with an error, the effects of the DDL statement will be rolled back, just as they would be in any other case where the containing transaction aborts.</p>
  <p>For a complete list of commands supported by the event trigger mechanism, see <a class="xref" href="event-trigger-matrix.html" title="39.2.&nbsp;Event Trigger Firing Matrix">Section&nbsp;39.2</a>.</p>
  <p>Event triggers are created using the command <a class="xref" href="sql-createeventtrigger.html" title="CREATE EVENT TRIGGER"><span class="refentrytitle">CREATE EVENT TRIGGER</span></a>. In order to create an event trigger, you must first create a function with the special return type <code class="literal">event_trigger</code>. This function need not (and may not) return a value; the return type serves merely as a signal that the function is to be invoked as an event trigger.</p>
  <p>If more than one event trigger is defined for a particular event, they will fire in alphabetical order by trigger name.</p>
  <p>A trigger definition can also specify a <code class="literal">WHEN</code> condition so that, for example, a <code class="literal">ddl_command_start</code> trigger can be fired only for particular commands which the user wishes to intercept. A common use of such triggers is to restrict the range of DDL operations which users may perform.</p>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="event-triggers.html" title="Chapter&nbsp;39.&nbsp;Event Triggers">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="event-triggers.html" title="Chapter&nbsp;39.&nbsp;Event Triggers">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="event-trigger-matrix.html" title="39.2.&nbsp;Event Trigger Firing Matrix">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">Chapter&nbsp;39.&nbsp;Event Triggers&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;39.2.&nbsp;Event Trigger Firing Matrix</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/13/event-trigger-definition.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> 
      </div>
    </div>
    
    
    
    
    
    
  </body>
</html>
