<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 13: PREPARE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/13/sql-prepare.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-02-20T14:13:26" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="PREPARE" />
  <meta property="og:description" content="PREPARE PREPARE — prepare a statement for execution Synopsis PREPARE name [ ( data_type [, ...] ) ] AS statement …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />


  

  
  
  
  
  

  

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          
          
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 20, 2025: <a href="/about/news/postgresql-174-168-1512-1417-and-1320-released-3018/">
  PostgreSQL 17.4, 16.8, 15.12, 14.17, and 13.20 Released!
</a>

</div>
      </div>
    </div>
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/13/index.html">PostgreSQL 13</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/sql-prepare.html" title="PostgreSQL 17 - PREPARE" >Current</a>
                          (<a href="/docs/17/sql-prepare.html" title="PostgreSQL 17 - PREPARE" >17</a>)
                        
                      
                         / 
                        
                          <a href="/docs/16/sql-prepare.html" title="PostgreSQL 16 - PREPARE" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/sql-prepare.html" title="PostgreSQL 15 - PREPARE" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/sql-prepare.html" title="PostgreSQL 14 - PREPARE" >14</a>
                        
                      
                         / 
                        
                          <a href="/docs/13/sql-prepare.html" title="PostgreSQL 13 - PREPARE" class="docs-version-selected">13</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/sql-prepare.html" title="PostgreSQL devel - PREPARE"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/12/sql-prepare.html" title="PostgreSQL 12 - PREPARE"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/sql-prepare.html" title="PostgreSQL 11 - PREPARE"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/sql-prepare.html" title="PostgreSQL 10 - PREPARE"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/sql-prepare.html" title="PostgreSQL 9.6 - PREPARE"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/sql-prepare.html" title="PostgreSQL 9.5 - PREPARE"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/sql-prepare.html" title="PostgreSQL 9.4 - PREPARE"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/sql-prepare.html" title="PostgreSQL 9.3 - PREPARE"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/sql-prepare.html" title="PostgreSQL 9.2 - PREPARE"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/sql-prepare.html" title="PostgreSQL 9.1 - PREPARE"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/sql-prepare.html" title="PostgreSQL 9.0 - PREPARE"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/sql-prepare.html" title="PostgreSQL 8.4 - PREPARE"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/sql-prepare.html" title="PostgreSQL 8.3 - PREPARE"  rel="nofollow">8.3</a>
                    
                       / 
                      <a href="/docs/8.2/sql-prepare.html" title="PostgreSQL 8.2 - PREPARE"  rel="nofollow">8.2</a>
                    
                       / 
                      <a href="/docs/8.1/sql-prepare.html" title="PostgreSQL 8.1 - PREPARE"  rel="nofollow">8.1</a>
                    
                       / 
                      <a href="/docs/8.0/sql-prepare.html" title="PostgreSQL 8.0 - PREPARE"  rel="nofollow">8.0</a>
                    
                       / 
                      <a href="/docs/7.4/sql-prepare.html" title="PostgreSQL 7.4 - PREPARE"  rel="nofollow">7.4</a>
                    
                       / 
                      <a href="/docs/7.3/sql-prepare.html" title="PostgreSQL 7.3 - PREPARE"  rel="nofollow">7.3</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/13/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div>
              </form>
            </div>
          </div>

          <div id="docContent">
            <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">PREPARE</th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="sql-notify.html" title="NOTIFY">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="sql-commands.html" title="SQL Commands">Up</a></td>
      <th width="60%" align="center">SQL Commands</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="sql-prepare-transaction.html" title="PREPARE TRANSACTION">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="refentry" id="SQL-PREPARE">
  <div class="titlepage"></div><a id="id-1.9.3.158.1" class="indexterm" name="id-1.9.3.158.1"></a><a id="id-1.9.3.158.2" class="indexterm" name="id-1.9.3.158.2"></a>
  <div class="refnamediv">
    <h2><span class="refentrytitle">PREPARE</span></h2>
    <p>PREPARE — prepare a statement for execution</p>
  </div>
  <div class="refsynopsisdiv">
    <h2>Synopsis</h2>
    <pre class="synopsis">
PREPARE <em class="replaceable"><code>name</code></em> [ ( <em class="replaceable"><code>data_type</code></em> [, ...] ) ] AS <em class="replaceable"><code>statement</code></em>
</pre>
  </div>
  <div class="refsect1" id="id-1.9.3.158.6">
    <h2>Description</h2>
    <p><code class="command">PREPARE</code> creates a prepared statement. A prepared statement is a server-side object that can be used to optimize performance. When the <code class="command">PREPARE</code> statement is executed, the specified statement is parsed, analyzed, and rewritten. When an <code class="command">EXECUTE</code> command is subsequently issued, the prepared statement is planned and executed. This division of labor avoids repetitive parse analysis work, while allowing the execution plan to depend on the specific parameter values supplied.</p>
    <p>Prepared statements can take parameters: values that are substituted into the statement when it is executed. When creating the prepared statement, refer to parameters by position, using <code class="literal">$1</code>, <code class="literal">$2</code>, etc. A corresponding list of parameter data types can optionally be specified. When a parameter's data type is not specified or is declared as <code class="literal">unknown</code>, the type is inferred from the context in which the parameter is first referenced (if possible). When executing the statement, specify the actual values for these parameters in the <code class="command">EXECUTE</code> statement. Refer to <a class="xref" href="sql-execute.html" title="EXECUTE"><span class="refentrytitle">EXECUTE</span></a> for more information about that.</p>
    <p>Prepared statements only last for the duration of the current database session. When the session ends, the prepared statement is forgotten, so it must be recreated before being used again. This also means that a single prepared statement cannot be used by multiple simultaneous database clients; however, each client can create their own prepared statement to use. Prepared statements can be manually cleaned up using the <a class="xref" href="sql-deallocate.html" title="DEALLOCATE"><span class="refentrytitle">DEALLOCATE</span></a> command.</p>
    <p>Prepared statements potentially have the largest performance advantage when a single session is being used to execute a large number of similar statements. The performance difference will be particularly significant if the statements are complex to plan or rewrite, e.g., if the query involves a join of many tables or requires the application of several rules. If the statement is relatively simple to plan and rewrite but relatively expensive to execute, the performance advantage of prepared statements will be less noticeable.</p>
  </div>
  <div class="refsect1" id="id-1.9.3.158.7">
    <h2>Parameters</h2>
    <div class="variablelist">
      <dl class="variablelist">
        <dt><span class="term"><em class="replaceable"><code>name</code></em></span></dt>
        <dd>
          <p>An arbitrary name given to this particular prepared statement. It must be unique within a single session and is subsequently used to execute or deallocate a previously prepared statement.</p>
        </dd>
        <dt><span class="term"><em class="replaceable"><code>data_type</code></em></span></dt>
        <dd>
          <p>The data type of a parameter to the prepared statement. If the data type of a particular parameter is unspecified or is specified as <code class="literal">unknown</code>, it will be inferred from the context in which the parameter is first referenced. To refer to the parameters in the prepared statement itself, use <code class="literal">$1</code>, <code class="literal">$2</code>, etc.</p>
        </dd>
        <dt><span class="term"><em class="replaceable"><code>statement</code></em></span></dt>
        <dd>
          <p>Any <code class="command">SELECT</code>, <code class="command">INSERT</code>, <code class="command">UPDATE</code>, <code class="command">DELETE</code>, or <code class="command">VALUES</code> statement.</p>
        </dd>
      </dl>
    </div>
  </div>
  <div class="refsect1" id="SQL-PREPARE-NOTES">
    <h2>Notes</h2>
    <p>A prepared statement can be executed with either a <em class="firstterm">generic plan</em> or a <em class="firstterm">custom plan</em>. A generic plan is the same across all executions, while a custom plan is generated for a specific execution using the parameter values given in that call. Use of a generic plan avoids planning overhead, but in some situations a custom plan will be much more efficient to execute because the planner can make use of knowledge of the parameter values. (Of course, if the prepared statement has no parameters, then this is moot and a generic plan is always used.)</p>
    <p>By default (that is, when <a class="xref" href="runtime-config-query.html#GUC-PLAN-CACHE_MODE">plan_cache_mode</a> is set to <code class="literal">auto</code>), the server will automatically choose whether to use a generic or custom plan for a prepared statement that has parameters. The current rule for this is that the first five executions are done with custom plans and the average estimated cost of those plans is calculated. Then a generic plan is created and its estimated cost is compared to the average custom-plan cost. Subsequent executions use the generic plan if its cost is not so much higher than the average custom-plan cost as to make repeated replanning seem preferable.</p>
    <p>This heuristic can be overridden, forcing the server to use either generic or custom plans, by setting <code class="varname">plan_cache_mode</code> to <code class="literal">force_generic_plan</code> or <code class="literal">force_custom_plan</code> respectively. This setting is primarily useful if the generic plan's cost estimate is badly off for some reason, allowing it to be chosen even though its actual cost is much more than that of a custom plan.</p>
    <p>To examine the query plan <span class="productname">PostgreSQL</span> is using for a prepared statement, use <a class="xref" href="sql-explain.html" title="EXPLAIN"><span class="refentrytitle">EXPLAIN</span></a>, for example</p>
    <pre class="programlisting">
EXPLAIN EXECUTE <em class="replaceable"><code>name</code></em>(<em class="replaceable"><code>parameter_values</code></em>);
</pre>
    <p>If a generic plan is in use, it will contain parameter symbols <code class="literal">$<em class="replaceable"><code>n</code></em></code>, while a custom plan will have the supplied parameter values substituted into it.</p>
    <p>For more information on query planning and the statistics collected by <span class="productname">PostgreSQL</span> for that purpose, see the <a class="xref" href="sql-analyze.html" title="ANALYZE"><span class="refentrytitle">ANALYZE</span></a> documentation.</p>
    <p>Although the main point of a prepared statement is to avoid repeated parse analysis and planning of the statement, <span class="productname">PostgreSQL</span> will force re-analysis and re-planning of the statement before using it whenever database objects used in the statement have undergone definitional (DDL) changes since the previous use of the prepared statement. Also, if the value of <a class="xref" href="runtime-config-client.html#GUC-SEARCH-PATH">search_path</a> changes from one use to the next, the statement will be re-parsed using the new <code class="varname">search_path</code>. (This latter behavior is new as of <span class="productname">PostgreSQL</span> 9.3.) These rules make use of a prepared statement semantically almost equivalent to re-submitting the same query text over and over, but with a performance benefit if no object definitions are changed, especially if the best plan remains the same across uses. An example of a case where the semantic equivalence is not perfect is that if the statement refers to a table by an unqualified name, and then a new table of the same name is created in a schema appearing earlier in the <code class="varname">search_path</code>, no automatic re-parse will occur since no object used in the statement changed. However, if some other change forces a re-parse, the new table will be referenced in subsequent uses.</p>
    <p>You can see all prepared statements available in the session by querying the <a class="link" href="view-pg-prepared-statements.html" title="51.76.&nbsp;pg_prepared_statements"><code class="structname">pg_prepared_statements</code></a> system view.</p>
  </div>
  <div class="refsect1" id="SQL-PREPARE-EXAMPLES">
    <h2>Examples</h2>
    <p>Create a prepared statement for an <code class="command">INSERT</code> statement, and then execute it:</p>
    <pre class="programlisting">
PREPARE fooplan (int, text, bool, numeric) AS
    INSERT INTO foo VALUES($1, $2, $3, $4);
EXECUTE fooplan(1, 'Hunter Valley', 't', 200.00);
</pre>
    <p>Create a prepared statement for a <code class="command">SELECT</code> statement, and then execute it:</p>
    <pre class="programlisting">
PREPARE usrrptplan (int) AS
    SELECT * FROM users u, logs l WHERE u.usrid=$1 AND u.usrid=l.usrid
    AND l.date = $2;
EXECUTE usrrptplan(1, current_date);
</pre>
    <p>In this example, the data type of the second parameter is not specified, so it is inferred from the context in which <code class="literal">$2</code> is used.</p>
  </div>
  <div class="refsect1" id="id-1.9.3.158.10">
    <h2>Compatibility</h2>
    <p>The SQL standard includes a <code class="command">PREPARE</code> statement, but it is only for use in embedded SQL. This version of the <code class="command">PREPARE</code> statement also uses a somewhat different syntax.</p>
  </div>
  <div class="refsect1" id="id-1.9.3.158.11">
    <h2>See Also</h2><span class="simplelist"><a class="xref" href="sql-deallocate.html" title="DEALLOCATE"><span class="refentrytitle">DEALLOCATE</span></a>, <a class="xref" href="sql-execute.html" title="EXECUTE"><span class="refentrytitle">EXECUTE</span></a></span>
  </div>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="sql-notify.html" title="NOTIFY">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="sql-commands.html" title="SQL Commands">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="sql-prepare-transaction.html" title="PREPARE TRANSACTION">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">NOTIFY&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;PREPARE TRANSACTION</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/13/sql-prepare.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> 
      </div>
    </div>
    
    
    
    
    
    
  </body>
</html>
