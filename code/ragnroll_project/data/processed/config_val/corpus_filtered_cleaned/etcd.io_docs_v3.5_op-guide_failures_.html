<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Failure modes | etcd</title>
<meta name=description content="Kinds of failures and etcd's tolerance for them"><meta property="og:url" content="https://etcd.io/docs/v3.5/op-guide/failures/"><meta property="og:site_name" content="etcd"><meta property="og:title" content="Failure modes"><meta property="og:description" content="Kinds of failures and etcd's tolerance for them"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-02-20T22:51:57+13:00"><meta itemprop=name content="Failure modes"><meta itemprop=description content="Kinds of failures and etcd's tolerance for them"><meta itemprop=dateModified content="2023-02-20T22:51:57+13:00"><meta itemprop=wordCount content="650"><meta name=twitter:card content="summary"><meta name=twitter:title content="Failure modes"><meta name=twitter:description content="Kinds of failures and etcd's tolerance for them"></head><body class=td-page><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><h1>Failure modes</h1><div class=lead>Kinds of failures and etcd&rsquo;s tolerance for them</div><p>Failures are common in a large deployment of machines. A machine fails when its hardware or software malfunctions. Multiple machines fail together when there are power failures or network issues. Multiple kinds of failures can also happen at once; it is almost impossible to enumerate all possible failure cases.</p><p>In this section, we catalog kinds of failures and discuss how etcd is designed to tolerate these failures. Most users, if not all, can map a particular failure into one kind of failure. To prepare for rare or <a href=../recovery/>unrecoverable failures</a>, always <a href=../maintenance/#snapshot-backup>back up</a> the etcd cluster.</p><h2 id=minor-followers-failure>Minor followers failure</h2><p>When fewer than half of the followers fail, the etcd cluster can still accept requests and make progress without any major disruption. For example, two follower failures will not affect a five member etcd cluster’s operation. However, clients will lose connectivity to the failed members. Client libraries should hide these interruptions from users for read requests by automatically reconnecting to other members. Operators should expect the system load on the other members to increase due to the reconnections.</p><h2 id=leader-failure>Leader failure</h2><p>When a leader fails, the etcd cluster automatically elects a new leader. The election does not happen instantly once the leader fails. It takes about an election timeout to elect a new leader since the failure detection model is timeout based.</p><p>During the leader election the cluster cannot process any writes. Write requests sent during the election are queued for processing until a new leader is elected.</p><p>Writes already sent to the old leader but not yet committed may be lost. The new leader has the power to rewrite any uncommitted entries from the previous leader. From the user perspective, some write requests might time out after a new leader election. However, no committed writes are ever lost.</p><p>The new leader extends timeouts automatically for all leases. This mechanism ensures a lease will not expire before the granted TTL even if it was granted by the old leader.</p><h2 id=majority-failure>Majority failure</h2><p>When the majority members of the cluster fail, the etcd cluster fails and cannot accept more writes.</p><p>The etcd cluster can only recover from a majority failure once the majority of members become available. If a majority of members cannot come back online, then the operator must start <a href=../recovery/>disaster recovery</a> to recover the cluster.</p><p>Once a majority of members works, the etcd cluster elects a new leader automatically and returns to a healthy state. The new leader extends timeouts automatically for all leases. This mechanism ensures no lease expires due to server side unavailability.</p><h2 id=network-partition>Network partition</h2><p>A network partition is similar to a minor followers failure or a leader failure. A network partition divides the etcd cluster into two parts; one with a member majority and the other with a member minority. The majority side becomes the available cluster and the minority side is unavailable. There is no “split-brain” in etcd because cluster members are explicitly added/removed with each such change is approved by the current majority of members.</p><p>If the leader is on the majority side, then from the majority point of view the failure is a minority follower failure. If the leader is on the minority side, then it is a leader failure. The leader on the minority side steps down and the majority side elects a new leader.</p><p>Once the network partition clears, the minority side automatically recognizes the leader from the majority side and recovers its state.</p><h2 id=failure-during-bootstrapping>Failure during bootstrapping</h2><p>A cluster bootstrap is only successful if all required members successfully start. If any failure happens during bootstrapping, remove the data directories on all members and re-bootstrap the cluster with a new cluster-token or new discovery token.</p><p>Of course, it is possible to recover a failed bootstrapped cluster like recovering a running cluster. However, it almost always takes more time and resources to recover that cluster than bootstrapping a new one, since there is no data to recover.</p><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/etcd-io/website/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/etcd-io/website/issues/new>tell us how we can improve</a>.</p></div><br><div class=td-page-meta__lastmod>Last modified February 20, 2023: <a href=https://github.com/etcd-io/website/commit/6aa3ed0c9c2a311164d8c2ef2a26ba34cb1f54e0>Fix minor spelling error in upgrade docs. (6aa3ed0)</a></div></div></main></div></div></div></body></html>