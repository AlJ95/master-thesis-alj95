<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 13: 42.2. Structure of PL/pgSQL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/13/plpgsql-structure.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2025-02-20T14:13:26" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="42.2. Structure of PL/pgSQL" />
  <meta property="og:description" content="42.2.&amp;nbsp;Structure of PL/pgSQL Functions written in PL/pgSQL are defined to the server by executing CREATE FUNCTION commands. Such a command …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />


  

  
  
  
  
  

  

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          
          
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 20, 2025: <a href="/about/news/postgresql-174-168-1512-1417-and-1320-released-3018/">
  PostgreSQL 17.4, 16.8, 15.12, 14.17, and 13.20 Released!
</a>

</div>
      </div>
    </div>
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/13/index.html">PostgreSQL 13</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/plpgsql-structure.html" title="PostgreSQL 17 - 42.2. Structure of PL/pgSQL" >Current</a>
                          (<a href="/docs/17/plpgsql-structure.html" title="PostgreSQL 17 - 42.2. Structure of PL/pgSQL" >17</a>)
                        
                      
                         / 
                        
                          <a href="/docs/16/plpgsql-structure.html" title="PostgreSQL 16 - 42.2. Structure of PL/pgSQL" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/plpgsql-structure.html" title="PostgreSQL 15 - 42.2. Structure of PL/pgSQL" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/plpgsql-structure.html" title="PostgreSQL 14 - 42.2. Structure of PL/pgSQL" >14</a>
                        
                      
                         / 
                        
                          <a href="/docs/13/plpgsql-structure.html" title="PostgreSQL 13 - 42.2. Structure of PL/pgSQL" class="docs-version-selected">13</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/plpgsql-structure.html" title="PostgreSQL devel - 42.2. Structure of PL/pgSQL"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/12/plpgsql-structure.html" title="PostgreSQL 12 - 42.2. Structure of PL/pgSQL"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/plpgsql-structure.html" title="PostgreSQL 11 - 42.2. Structure of PL/pgSQL"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/plpgsql-structure.html" title="PostgreSQL 10 - 42.2. Structure of PL/pgSQL"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/plpgsql-structure.html" title="PostgreSQL 9.6 - 42.2. Structure of PL/pgSQL"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/plpgsql-structure.html" title="PostgreSQL 9.5 - 42.2. Structure of PL/pgSQL"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/plpgsql-structure.html" title="PostgreSQL 9.4 - 42.2. Structure of PL/pgSQL"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/plpgsql-structure.html" title="PostgreSQL 9.3 - 42.2. Structure of PL/pgSQL"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/plpgsql-structure.html" title="PostgreSQL 9.2 - 42.2. Structure of PL/pgSQL"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/plpgsql-structure.html" title="PostgreSQL 9.1 - 42.2. Structure of PL/pgSQL"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/plpgsql-structure.html" title="PostgreSQL 9.0 - 42.2. Structure of PL/pgSQL"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/plpgsql-structure.html" title="PostgreSQL 8.4 - 42.2. Structure of PL/pgSQL"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/plpgsql-structure.html" title="PostgreSQL 8.3 - 42.2. Structure of PL/pgSQL"  rel="nofollow">8.3</a>
                    
                       / 
                      <a href="/docs/8.2/plpgsql-structure.html" title="PostgreSQL 8.2 - 42.2. Structure of PL/pgSQL"  rel="nofollow">8.2</a>
                    
                       / 
                      <a href="/docs/8.1/plpgsql-structure.html" title="PostgreSQL 8.1 - 42.2. Structure of PL/pgSQL"  rel="nofollow">8.1</a>
                    
                       / 
                      <a href="/docs/8.0/plpgsql-structure.html" title="PostgreSQL 8.0 - 42.2. Structure of PL/pgSQL"  rel="nofollow">8.0</a>
                    
                       / 
                      <a href="/docs/7.4/plpgsql-structure.html" title="PostgreSQL 7.4 - 42.2. Structure of PL/pgSQL"  rel="nofollow">7.4</a>
                    
                       / 
                      <a href="/docs/7.3/plpgsql-structure.html" title="PostgreSQL 7.3 - 42.2. Structure of PL/pgSQL"  rel="nofollow">7.3</a>
                    
                       / 
                      <a href="/docs/7.2/plpgsql-structure.html" title="PostgreSQL 7.2 - 42.2. Structure of PL/pgSQL"  rel="nofollow">7.2</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/13/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div>
              </form>
            </div>
          </div>

          <div id="docContent">
            <div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">42.2.&nbsp;Structure of <span xmlns="http://www.w3.org/1999/xhtml" class="application">PL/pgSQL</span></th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="plpgsql-overview.html" title="42.1.&nbsp;Overview">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="plpgsql.html" title="Chapter&nbsp;42.&nbsp;PL/pgSQL — SQL Procedural Language">Up</a></td>
      <th width="60%" align="center">Chapter&nbsp;42.&nbsp;<span xmlns="http://www.w3.org/1999/xhtml" class="application">PL/pgSQL</span> — <acronym xmlns="http://www.w3.org/1999/xhtml" class="acronym">SQL</acronym> Procedural Language</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="plpgsql-declarations.html" title="42.3.&nbsp;Declarations">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="sect1" id="PLPGSQL-STRUCTURE">
  <div class="titlepage">
    <div>
      <div>
        <h2 class="title" style="clear: both">42.2.&nbsp;Structure of <span class="application">PL/pgSQL</span></h2>
      </div>
    </div>
  </div>
  <p>Functions written in <span class="application">PL/pgSQL</span> are defined to the server by executing <a class="xref" href="sql-createfunction.html" title="CREATE FUNCTION"><span class="refentrytitle">CREATE FUNCTION</span></a> commands. Such a command would normally look like, say,</p>
  <pre class="programlisting">
CREATE FUNCTION somefunc(integer, text) RETURNS integer
AS '<em class="replaceable"><code>function body text</code></em>'
LANGUAGE plpgsql;
</pre>
  <p>The function body is simply a string literal so far as <code class="command">CREATE FUNCTION</code> is concerned. It is often helpful to use dollar quoting (see <a class="xref" href="sql-syntax-lexical.html#SQL-SYNTAX-DOLLAR-QUOTING" title="4.1.2.4.&nbsp;Dollar-Quoted String Constants">Section&nbsp;4.1.2.4</a>) to write the function body, rather than the normal single quote syntax. Without dollar quoting, any single quotes or backslashes in the function body must be escaped by doubling them. Almost all the examples in this chapter use dollar-quoted literals for their function bodies.</p>
  <p><span class="application">PL/pgSQL</span> is a block-structured language. The complete text of a function body must be a <em class="firstterm">block</em>. A block is defined as:</p>
  <pre class="synopsis">
[<span class="optional"> &lt;&lt;<em class="replaceable"><code>label</code></em>&gt;&gt; </span>]
[<span class="optional"> DECLARE
    <em class="replaceable"><code>declarations</code></em> </span>]
BEGIN
    <em class="replaceable"><code>statements</code></em>
END [<span class="optional"> <em class="replaceable"><code>label</code></em> </span>];
</pre>
  <p>Each declaration and each statement within a block is terminated by a semicolon. A block that appears within another block must have a semicolon after <code class="literal">END</code>, as shown above; however the final <code class="literal">END</code> that concludes a function body does not require a semicolon.</p>
  <div class="tip">
    <h3 class="title">Tip</h3>
    <p>A common mistake is to write a semicolon immediately after <code class="literal">BEGIN</code>. This is incorrect and will result in a syntax error.</p>
  </div>
  <p>A <em class="replaceable"><code>label</code></em> is only needed if you want to identify the block for use in an <code class="literal">EXIT</code> statement, or to qualify the names of the variables declared in the block. If a label is given after <code class="literal">END</code>, it must match the label at the block's beginning.</p>
  <p>All key words are case-insensitive. Identifiers are implicitly converted to lower case unless double-quoted, just as they are in ordinary SQL commands.</p>
  <p>Comments work the same way in <span class="application">PL/pgSQL</span> code as in ordinary SQL. A double dash (<code class="literal">--</code>) starts a comment that extends to the end of the line. A <code class="literal">/*</code> starts a block comment that extends to the matching occurrence of <code class="literal">*/</code>. Block comments nest.</p>
  <p>Any statement in the statement section of a block can be a <em class="firstterm">subblock</em>. Subblocks can be used for logical grouping or to localize variables to a small group of statements. Variables declared in a subblock mask any similarly-named variables of outer blocks for the duration of the subblock; but you can access the outer variables anyway if you qualify their names with their block's label. For example:</p>
  <pre class="programlisting">
CREATE FUNCTION somefunc() RETURNS integer AS $$
&lt;&lt; outerblock &gt;&gt;
DECLARE
    quantity integer := 30;
BEGIN
    RAISE NOTICE 'Quantity here is %', quantity;  -- Prints 30
    quantity := 50;
    --
    -- Create a subblock
    --
    DECLARE
        quantity integer := 80;
    BEGIN
        RAISE NOTICE 'Quantity here is %', quantity;  -- Prints 80
        RAISE NOTICE 'Outer quantity here is %', outerblock.quantity;  -- Prints 50
    END;

    RAISE NOTICE 'Quantity here is %', quantity;  -- Prints 50

    RETURN quantity;
END;
$$ LANGUAGE plpgsql;
</pre>
  <div class="note">
    <h3 class="title">Note</h3>
    <p>There is actually a hidden <span class="quote">“<span class="quote">outer block</span>”</span> surrounding the body of any <span class="application">PL/pgSQL</span> function. This block provides the declarations of the function's parameters (if any), as well as some special variables such as <code class="literal">FOUND</code> (see <a class="xref" href="plpgsql-statements.html#PLPGSQL-STATEMENTS-DIAGNOSTICS" title="42.5.5.&nbsp;Obtaining the Result Status">Section&nbsp;42.5.5</a>). The outer block is labeled with the function's name, meaning that parameters and special variables can be qualified with the function's name.</p>
  </div>
  <p>It is important not to confuse the use of <code class="command">BEGIN</code>/<code class="command">END</code> for grouping statements in <span class="application">PL/pgSQL</span> with the similarly-named SQL commands for transaction control. <span class="application">PL/pgSQL</span>'s <code class="command">BEGIN</code>/<code class="command">END</code> are only for grouping; they do not start or end a transaction. See <a class="xref" href="plpgsql-transactions.html" title="42.8.&nbsp;Transaction Management">Section&nbsp;42.8</a> for information on managing transactions in <span class="application">PL/pgSQL</span>. Also, a block containing an <code class="literal">EXCEPTION</code> clause effectively forms a subtransaction that can be rolled back without affecting the outer transaction. For more about that see <a class="xref" href="plpgsql-control-structures.html#PLPGSQL-ERROR-TRAPPING" title="42.6.8.&nbsp;Trapping Errors">Section&nbsp;42.6.8</a>.</p>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="plpgsql-overview.html" title="42.1.&nbsp;Overview">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="plpgsql.html" title="Chapter&nbsp;42.&nbsp;PL/pgSQL — SQL Procedural Language">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="plpgsql-declarations.html" title="42.3.&nbsp;Declarations">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">42.1.&nbsp;Overview&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 13.20 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;42.3.&nbsp;Declarations</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/13/plpgsql-structure.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> 
      </div>
    </div>
    
    
    
    
    
    
  </body>
</html>
